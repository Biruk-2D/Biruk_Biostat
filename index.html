<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>County Diabetes Prevalence Estimator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        .container {
            padding: 20px;
        }

        .welcome {
            background-color: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 800px;
            text-align: left;
            line-height: 1.6;
        }

        h1 {
            color: #2e7d32;
        }

        .slider-container {
            margin-top: 30px;
            text-align: left;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .slider-label {
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
        }

        .circle-container {
            margin-top: 50px;
        }

        svg {
            display: block;
            margin: 0 auto;
        }

        .results {
            margin-top: 30px;
            font-size: 1.2em;
        }

        #circle-text {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="welcome">
            <h1>County Diabetes Prevalence Estimator</h1>
            <p>Adjust the sliders to see how obesity, smoking, and uninsured population influence diabetes prevalence at a county level.</p>
        </div>

        <div class="slider-container">
            <div>
                <label class="slider-label">Obesity Proportion (%): <span id="value1">30</span></label>
                <input type="range" id="slider1" min="0" max="100" value="30">
            </div>
            <div>
                <label class="slider-label">Current Smokers (%): <span id="value2">15</span></label>
                <input type="range" id="slider2" min="0" max="100" value="15">
            </div>
            <div>
                <label class="slider-label">Uninsured Persons (in thousands): <span id="value3">10</span></label>
                <input type="range" id="slider3" min="0" max="50" value="10">
            </div>
        </div>

        <div class="circle-container">
            <svg width="120" height="120">
                <circle cx="60" cy="60" r="50" stroke="lightgray" stroke-width="10" fill="none" />
                <circle id="circle" cx="60" cy="60" r="50" stroke="blue" stroke-width="10" fill="none" stroke-dasharray="0" stroke-dashoffset="0" transform="rotate(-90 60 60)" />
                <text id="circle-text" x="50%" y="50%" text-anchor="middle" fill="black" font-size="20" dy=".3em">0</text>
            </svg>
        </div>

        <div class="results">
            <h2>Predicted Diabetes Prevalence: <span id="y-value">0</span>%</h2>
        </div>
    </div>

    <script>
        // Get DOM Elements
        const sliders = [
            document.getElementById('slider1'), // Obesity
            document.getElementById('slider2'), // Smoking
            document.getElementById('slider3')  // Uninsured in thousands
        ];

        const values = [
            document.getElementById('value1'),
            document.getElementById('value2'),
            document.getElementById('value3')
        ];

        const yValue = document.getElementById('y-value');
        const circle = document.getElementById('circle');
        const circleText = document.getElementById('circle-text');

        // Coefficients from Model 4 (no alcohol, uninsured scaled in thousands)
        const intercept = 8.763;
        const coefficients = [
            0.045,      // Obesity
            0.208,      // Smoking
            0.0000273   // Uninsured count (thousands)
        ];

        function calculateY(inputs) {
            let Y = intercept;
            Y += coefficients[0] * inputs[0]; // Obesity
            Y += coefficients[1] * inputs[1]; // Smoking
            Y += coefficients[2] * (inputs[2] * 1000); // Scale uninsured back to count
            return Math.min(Y.toFixed(2), 100);  // Cap at 100%
        }

        function updateCircle(Y) {
            const circumference = 2 * Math.PI * 50;
            const offset = circumference - (Y / 100) * circumference;
            circle.style.strokeDasharray = `${circumference}`;
            circle.style.strokeDashoffset = offset;
            circleText.textContent = `${Y}%`;
        }

        function updateResults() {
            const inputs = sliders.map(slider => parseFloat(slider.value));
            inputs.forEach((val, idx) => values[idx].textContent = val);
            const Y = calculateY(inputs);
            yValue.textContent = Y;
            updateCircle(Y);
        }

        // Event listeners
        sliders.forEach(slider => slider.addEventListener('input', updateResults));

        // Initial calculation
        updateResults();
    </script>
</body>
</html>
